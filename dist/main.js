(()=>{const t=document.getElementById("history-button"),n=document.getElementById("history-list"),e=document.getElementById("buttons-container"),o=document.querySelectorAll(".number-button"),m=document.querySelectorAll(".operator-button"),s=document.querySelector(".allclear-button"),u=document.querySelector(".back-button"),i=document.querySelector(".decimal-button"),l=document.querySelector(".equal-button"),c=document.querySelector(".plusminus-button"),r=document.getElementById("main-operation"),a=document.getElementById("main-answer"),d={num1:"",operation:"",symbol:"",num2:"",ans:""},p={add:(t,n)=>t+n,sub:(t,n)=>t-n,mul:(t,n)=>t*n,div:(t,n)=>t/n,power:(t,n)=>Math.pow(t,n),sqrt:(t,n)=>Math.sqrt(t)};function y(){return d.ans?"complete":d.num1?d.num1&&!d.operation?"num1 incomplete":d.num1&&d.operation&&!d.num2?"num2 empty":d.operation&&d.num2?"num2 incomplete":void 0:"num1 empty"}function g(){d.num1="",d.operation="",d.symbol="",d.num2="",d.ans="",r.textContent="",a.textContent=""}function h(){d.ans&&"sqrt"===d.operation?(r.textContent=`${d.symbol}${d.num1}`,a.textContent=d.ans):(r.textContent=`${d.num1}${d.symbol}${d.num2}`,a.textContent=d.ans),d.ans&&(r.textContent+=" =")}function b(){const t=function(t){let n="",e="";if(t.includes(".")){const o=t.split(".");n=o[0].length,e=o[1].length}else n=t.length;if(n>9||t.includes("e")&&e>5)return Number(t).toExponential(5).toString();if(n+e>9){const e=11-n;return parseFloat(Number(t).toFixed(e).toString())}return t}(p[d.operation](Number(d.num1),Number(d.num2)).toString()).toString();d.ans=t,h(),function(){const t=document.createElement("div");t.classList.add("history-item");const e=document.createElement("div");e.classList.add("spacer");const o=document.createElement("div");o.classList.add("history-operation"),o.textContent=r.textContent;const m=document.createElement("div");m.classList.add("history-answer"),m.textContent=a.textContent,m.addEventListener("click",(()=>{const t=y();"complete"===t||"num1 empty"===t?(g(),d.num1=m.textContent):"num2 empty"===t&&(d.num2=m.textContent),h(),n.classList.toggle("history-list-closed"),n.classList.toggle("history-list-open")})),t.appendChild(e),t.appendChild(o),t.appendChild(m),n.prepend(t)}()}t.addEventListener("click",(()=>{n.classList.toggle("history-list-closed"),n.classList.toggle("history-list-open")})),e.addEventListener("click",(()=>{n.classList.contains("history-list-open")&&(n.classList.toggle("history-list-closed"),n.classList.toggle("history-list-open"))})),o.forEach((t=>{t.addEventListener("click",(()=>{const n=y(),e=t.textContent;if("complete"===n)g(),d.num1=e;else if("num1 empty"===n||"num1 incomplete"===n){if(d.num1.replace(".","").length>=9)return;d.num1+=e}else{if(d.num2.replace(".","").length>=9)return;d.num2+=e}h()}))})),i.addEventListener("click",(()=>{const t=y();if("complete"!==t||!d.ans.includes(".")){if("complete"===t){const t=d.ans;g(),d.num1=`${t}.`}else if("num1 empty"===t||"num1 incomplete"===t){if(d.num1.includes(".")||d.num1.length>=9)return;"num1 empty"===t&&(d.num1+="0"),d.num1+="."}else{if(d.num2.includes(".")||d.num2.length>=9)return;"num2 empty"===t&&(d.num2+="0"),d.num2+="."}h()}})),m.forEach((t=>{t.addEventListener("click",(()=>{const n=y(),e=t.dataset.operator,o=t.textContent;"num1 empty"!==n&&("num2 incomplete"===n&&"sqrt"!=e||("complete"===n&&"sqrt"!=e?(d.num1=d.ans,d.operation=e,d.symbol=o,d.num2="",d.ans=""):"sqrt"!=e?"num1 empty"===n||"num1 incomplete"===n?("."===d.num1.charAt(d.num1.length-1)&&(d.num1+="0"),d.operation=e,d.symbol=o):(d.operation=e,d.symbol=o):"sqrt"===e&&("complete"===n?(d.num1=d.ans,d.operation=e,d.symbol=o,d.num2="1",b()):("."===d.num1.charAt(d.num1.length-1)&&(d.num1+="0"),d.operation=e,d.symbol=o,d.num2="1",b())),h()))}))})),s.addEventListener("click",(()=>{g()})),u.addEventListener("click",(()=>{const t=y();if("num1 empty"!==t){if("complete"===t){const t=d.ans.slice(0,-1);g(),d.num1=t}else"num2 empty"===t?(d.operation="",d.symbol=""):"num1 incomplete"===t?d.num1=d.num1.slice(0,-1):d.num2=d.num2.slice(0,-1);h()}})),c.addEventListener("click",(()=>{const t=y();if("complete"===t){const t=(-1*d.ans).toString();g(),d.num1=t}else"num1 incomplete"===t?d.num1=(-1*d.num1).toString():"num2 incomplete"===t&&(d.num2=(-1*d.num2).toString());h()})),l.addEventListener("click",(()=>{!d.ans&&d.num1&&d.operation&&d.num2&&("."===d.num2.charAt(d.num2.length-1)&&(d.num2+="0"),b())}))})();